
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>My little software store</title>
  <meta name="author" content="Federico Paolinelli">

  
  <meta name="description" content="I have been curious about intellij since droicon uk 2011, where I noticed that some of the speakers were using IntelliJ instead of eclipse.A post &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://fedepaol.github.io/posts/3">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="My little software store" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-16514009-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">My little software store</a></h1>
  
    <h2>Random thoughts about my experience as moonlight software developer.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:fedepaol.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/07/23/intellij-robolectric-and-android/">Intellij, Robolectric and Android</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-07-23'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<br /><br />I have been curious about intellij since droicon uk 2011, where I noticed that some of the speakers were using IntelliJ instead of eclipse.<br /><br />A <a href="https://plus.google.com/115995639636688350464/posts/CgPZkFGvbm3">post</a> from Richard Hyndman, who is a developer advocate from Google, was the final straw that pushed me to download IntelliJ and give it a try.<br /><br />The first thing an eclipse user will notice in intellij is how slick and fast compares to the behemoth which is eclipse. On the other hand, an you can feel a bit disoriented at first.<br /><br /><br />Setting up a new android project using IntelliJ is pretty straightforward. You can follow the nice tutorial from jetbrains website http://wiki.jetbrains.net/intellij/Android.<br />For this reason, I will not write about how to set up an Android project in intellij here.<br /><br /><br />What I am going to write about is how to setup an <b>android project with intellij and integrate robolectric</b> with it.<br /><br />I really like robolectric. It makes unit testing for android a lot faster as it would be on the emulator. What&#8217;s more, you can use mockito with it.<br />Mockito is a mocking framework that makes a lot easier to mock your java objects.<br />Mockito does not work with dalvik jvm, but robolectric makes your tests run on your pc&#8217;s jvm.<br /><br /><br />Despite robolectric provides instruction on how to setup an intellij project manually, I have tried that process a lot of times, carefully checking if I was missing a step.<br />However, I did not manage to get it working. The guys from Pivotal provide also an intellij starter project, which you can configure to point a git repository https://github.com/pivotal/AndroidIntelliJStarter<br /><br /><br />However, I was not either satisfied with this solution and, inspired by this <a href="https://groups.google.com/forum/?fromgroups#!topic/robolectric/QN6dskFjrHc">post</a>&nbsp;,&nbsp;I tried to setup a maven solution and to import it in intellij afterwards.<br /><br />This provides another great benefit, which is the fact that I can import the same project in my linux netbook without bothering for relative paths in eclipse projects.<br /><br />So, here are the steps I had to follow in order to get it working:<br /><br />- Install the android sdk. This is trivial, I assume you are comfortable with that<br />- Let the ANDROID_HOME environment variable point the path where you uncompressed the android sdk<br />- You need to have at least one version of the sdk installed, so if you haven&#8217;t yet, you should launch the sdk manager that is the &#8220;android&#8221; executable on ANDROID_HOME/tools/android. Install also the extras, such as the compatibility library, admob stuff and all the libraries you find at the bottom<br /><br /><br />- install the maven android sdk deployer you can find at <a href="https://github.com/mosabua/maven-android-sdk-deployer">https://github.com/mosabua/maven-android-sdk-deployer </a>and then install it.<br /><br />I read somewhere that you can get android jar without relying on it, but in any case, if you need google maps or other private apis like that you still need to use this tool.<br />&nbsp;I use the latest (almost) version which is 4.0.3, so I run mvn install -P 4.0.3<br /><br /><br />- Install maven android plugin. The easiest way is to use android archetypes from here:<br />https://github.com/akquinet/android-archetypes<br /><br /><br />Finally, you are now ready to generate your first maven android project:<br /><br /><br /><br /><br /><br />mvn archetype:generate \<br />&nbsp; -DarchetypeArtifactId=android-quickstart \<br />&nbsp; -DarchetypeGroupId=de.akquinet.android.archetypes \<br />&nbsp; -DarchetypeVersion=1.0.8 \<br />&nbsp; -DgroupId=your.company \<br />&nbsp; -DartifactId=my-android-application<br /><br /><br /><br />You <i>could</i> find an issue. &nbsp;Recently the tree of the android sdk folders has been slightly changed. Maven android plugin expects them to be in the updated version (I don&#8217;t remember what the differences where). However, if maven complains it cannot find android related stuff, and your sdk has been installed for some time, a good option would be to remove the sdk and reinstall it from scratch (at least the part you download with the sdk manager).<br /><br /><br /><br />At this point, you have a working maven project, which you could already open with intellij. What is still missing is the robolectric dependencies.<br />Nothing more easy, all you have to do is to add<br /><br /><br /><br /><br /><script src="https://gist.github.com/3165830.js?file=aaa.xml"></script> right below android dependencies.  You should also create the test folder, under <i>src/test/your/package/ </i><br /><br />Now, a problem I had was that I had to change the pointer of the repository in order to have robolectric 1.2 working.<br /><div><br /></div><div><br /></div><div><br /></div><br /><script src="https://gist.github.com/3165854.js?file=bbb.xml"></script><br /><br /><br /><br /><br />At this point, you should be able to open the pom.xml with intellij.<br /><br /><br />Now, to have robolectric working from intellij, you still need to make a couple of changes:<br />- the order of include of jars does not respect the one you specified. What&#8217;s more, you will likely to get the STUB! error because android jar is included before junit and robolectric.<br />All you need to do is to move the android jar below junit and robolectric<br /><br />- you need to manually specify the javadocs for android. You do this by highlighting android jar, pressing the little edit in the lower left corner.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-Cix5eHOX7ik/UA2uDjBWp2I/AAAAAAAAHso/ctXgbFyx8Tg/s1600/intellij1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="200" src="http://3.bp.blogspot.com/-Cix5eHOX7ik/UA2uDjBWp2I/AAAAAAAAHso/ctXgbFyx8Tg/s320/intellij1.png" width="320" /></a></div><br /><br /><br />and pressing the plus sign. Then you choose &#8220;Attach files or directories&#8221;, point the path related to your android docs,<br />which is /docs/references under your ANDROID_HOME. Finally, you declare that it&#8217;s related to javadoc.<br /><br /><br /><br /><br />Now you are _almost_ ready to start. You made all this mess because you want to have robolectric working with intellij.<br /><br />You need to create, right under src/ folder, the following path:<br /><i>src/test/java/ YOUR_PACKAGE&nbsp;</i><br /><i><br /></i><br />where you are going to include your unit tests, and you are done!<br /><br /><br />If you liked this post, please consider following me @fedepaol .<br /><br /><br /><br /><br /><div><br /></div><br /><div><br /></div></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Federico Paolinelli</div>
<div class='content'>
I added here https://dl.dropbox.com/u/3092639/pom.xml a working pom.xml I am currently using. I just tried to mvn clean install from a clean checkout and it looks to be finding robolectric. I hope you are missing something which you can correct using this example. Ping me if you can&#39;t</div>
</div>
<div class='comment'>
<div class='author'>Christopher Perry</div>
<div class='content'>
I added the sonatype repository stuff, and it&#39;s not finding robolectric. Not sure why.</div>
</div>
<div class='comment'>
<div class='author'>Christopher Perry</div>
<div class='content'>
This comment has been removed by the author.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/05/01/tcp-connections-in-android/">Tcp Connections in Android</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-05-01'><span class='date'><span class='date-month'>May</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<span style="font-size: large;">Or how to keep your app connected and stop worrying.&nbsp;</span><br /><br /><i>Disclaimer</i>:<br />This is not another place where you can find java code snippet to open a socket and read and write to some server.<br />If you need that, go back to your favorite search engine and look for another result. <u>But be careful</u>: while looking for &#8220;inspiration&#8221; I found a lot of examples where the connection was held inside the UI thread. Please, don&#8217;t do that. At least use an asynctask.<br /><br /><br /><span style="font-size: large;"><i>Short version of this post (spolier warning):</i></span><br /><br /><ul><li>If you need to interact with a tcp server, use a singleton object that contains the socket&nbsp;</li><li>You can access it from all the activities of your app</li><li>If you want to be connected only while in foreground, have a counter that gets incremented on onStart() and gets decremented on onStop() of any client activity. Connect when the counter is &gt; 0, disconnect when the counter is &lt; 0<br /><div><br /></div></li></ul><br /><br /><br /><span style="font-size: large;">Background:</span><br />As a side project, I am developing a simple turn based multiplayer game, with a tcp server as backend (python twisted).<br /><br />In order to make my life easier, I wanted the interaction with the server to work as follows:<br /><br /><br /><ul><li>if the player gets disconnected while playing, it can&#8217;t reconnect and he is out of the current game</li><li>if the app goes background for any reason, it will disconnect from the server</li></ul><div><br /></div><div>The way the app interacts with the server is not the subject of the current post (hint: a thread for sending, one for receiving AND google protobuf for serialization), but it will probably be the subject for some code on github and another blogpost.</div><div><br /></div><div>What I am writing about is <b>how to share a tcp connection between several android activities.</b></div><div><b><br /></b></div><div><br /></div><div><span style="font-size: large;">Using a service to share the socket between android activities:</span></div><div><br /></div><div><ul><li>if you think about something that needs to survive between activities transition, a service is the first&nbsp;thing you think about</li><li>the code to interact with the server was self contained, so in every activity I had to bind to the service, wait for the bind to be done, call the service that called my code</li><li>because of the constraint I imposed to make the tcp server easier, I had to stop the service and restart it whenever my app went background</li><li>I was risking to keep the service around, consuming resources with no reason</li></ul><div>So, use a service ONLY if you really need to keep the connection even if your app is no longer visible.</div></div><div>If you need to do periodical tasks, or if you need to perform one shot operations, please consider using intent services.&nbsp;</div><div>Be kind and let your users know that you are draining their battery, using a notification icon when the service is alive and your app gets backgrounded.</div><div><br /></div><div><span style="font-size: large;">Using a singleton to share the tcp socket:</span></div><div><ul><li>A singleton object resides in your process, and so once started it&#8217;s accessible from all the activities</li><li>You can even run one or more threads inside of it, and they will be running no matter which activity is visible</li><li>Not using a service, you authorize the os to suspend your application (or even to kill it) when it runs out of resources.</li><li>There is no need to have the service layer to bind from the activity, you can access directly your singleton object</li></ul><div>So, this is the BEST WAY to share a tcp connection between activities.</div></div><div><br /></div><div>But what if you want to connect only when the application is foregrounded?</div><div><br /></div><div><span style="font-size: large;">How to check when your application is active:</span></div><div>Have a global counter (a good place might be the singleton itself) that gets incremented every time an onStart() is called from one of your activities, and decremented when onStop() gets called.&nbsp;</div><div><br /></div><div>If that counter is &gt; 0, that means the (at least) one activity is active and then the socket must be connected.</div><div>On the other hand, if the counter gets to 0, no activity is visible and so you need to disconnect.</div><div><br /></div><div>If you are afraid that the counter might go to 0 only because an activity is starting another one and so its onStop() gets called before onStart of the next one, please note that the official android documentation assures us that when starting one activity from another, &nbsp;onStop gets called AFTER onStart() of the started activity <a href="http://developer.android.com/guide/topics/fundamentals/activities.html">http://developer.android.com/guide/topics/fundamentals/activities.html</a>.</div><div><br /></div><div>With that in mind, we are sure that the only time the counter will get to 0 is when the ALL the activities are stopped.</div><div><br /></div><div><br /></div><div>If you liked this post, please consider following me on twitter @fedepaol .</div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/01/30/postmanlib-android-and-rest-web/">PostmanLib - Android and Rest Web Services</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-01-30'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<span style="font-size: large;">Edit 2013-03-10: I&#8217;ve performed a substancial refactoring of postmanlib, and the details can be found in <a href="/blog/2013/03/06/postman-ringstwice-reloaded-android">this new post</a></span><br /><br />With the development of <a href="https://market.android.com/details?id=com.smokingbytes.santas">MyDearSanta</a> app, I needed to fetch and put some data to a rest service developed using django python framework with a simple set of json based rest apis.<br /><br />The development of the interaction between <b>android and the rest web service</b> was a bit messy because I was in hurry to release the app before Christmas (giving it&#8217;s xmas related nature), but while developing it I thought it could have been a good start for my first android library. And so it was.<br /><br />Yesterday I finally managed to write a first use case of my PostmanLib (rings twice) android library. I must confess it tooks nearly a couple of hours just to get a nice name, but I really like this one.<br /><br /><span style="font-size: large;">You can check the library <a href="https://github.com/fedepaol/PostmanLib--Rings-Twice--Android">HERE</a></span><br /><br />It&#8217;s barely inspired by Virgil Dobjanschi talk at google io 2010, and its relies on the common pattern is to make the one-shot background work inside intent services, let them update the model with the results of their work and then notify the interface when the model it&#8217;s changed, so that it can refresh itself.<br /><br />It does not provide a way to serialize your data into <b>json</b> nor how to store it into a content provider. There are a plenty of examples out there if you look for <u>json, android, rest</u> and other keyword like those and what&#8217;s more, they really depends on the interface your server is offering.<br /><br />What was missing was a common and clean way to interact with the service without using the &#8220;asynctask inside an activity&#8221; approach, which I don&#8217;t really like because of the well known issues of&nbsp;configuration changes.<br /><br />All you need to do with my lib is to implement the abstract methods of a Command class, such as the execute method that will be called inside the intentservice which is the method that performs the real work, and some method to serialize / deserialize the command inside an intent.<br />The library comes along with a singleton helper class that can be used in activities to fire the commands and get notified with their results.<br /><br />The steps are:<br /><br /><ul><li>the activity gets a reference to the helper</li><li>a command is sent to the intent service (serialized in an intent)</li><li>the intent service executes the command and updates the model (sqlite, shared prefs, content provider, whatever)</li><li>if the activity was registered as event listener, gets notified of the result and can check again the model (or notify the user about an error)</li><li>the activity can ask the helper about any in progress services (it can be useful in onresume stage to notify the user)</li></ul><div><br /></div><div>You will still have to implement the real <b>interaction between Android and the web service</b></div><br /><br />&nbsp;It&#8217;s far from be completed, but I am really enjoying how it is growing, and I hope it might be of some help for somebody.<br /><br />If you are curious about that, just checkout it from github here&nbsp;<a href="https://github.com/fedepaol/PostmanLib--Rings-Twice--Android">Android rest service interaction</a></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/01/22/pastimer-android-kitchen-timer-released/">Pastimer - Android Kitchen Timer (Released)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-01-22'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
Pastimer, my barcode based kitchen timer is now on the market.<br /><br />The basic idea is to scan the barcode on the box to set the time.<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><object width="320" height="266" class="BLOGGER-youtube-video" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" data-thumbnail-src="http://i.ytimg.com/vi/k-cG6rnXieQ/0.jpg"><param name="movie" value="http://www.youtube.com/v/k-cG6rnXieQ?version=3&f=user_uploads&c=google-webdrive-0&app=youtube_gdata" /><param name="bgcolor" value="#FFFFFF" /><embed width="320" height="266"  src="http://www.youtube.com/v/k-cG6rnXieQ?version=3&f=user_uploads&c=google-webdrive-0&app=youtube_gdata" type="application/x-shockwave-flash"></embed></object></div><br /><br />The url to download it from the market is<br /><a href="https://market.android.com/details?id=com.whiterabbit.pastimer">https://market.android.com/details?id=com.whiterabbit.pastimer</a><br /><br />or this for the lite version<br /><br /><a href="https://market.android.com/details?id=com.whiterabbit.pastimer.lite">https://market.android.com/details?id=com.whiterabbit.pastimer.lite</a><br /><br /><br />The description of the product can be found here&nbsp;<a href="https://sites.google.com/site/pastimerand/">Android Kitchen Timer</a></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/12/05/mydearsanta/">MyDearSanta</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2011-12-05'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2011</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
This time, while PastTimer has not been released yet, I started an experiment with an old friend. We wanted not just to release another standalone app, but interact in some way with a backend.<br /><br />The result is&nbsp;<a href="http://www.mydearsanta.info/">www.mydearsanta.info</a>&nbsp;, a web based Christmas list, which comes together with and Android app&nbsp;<a href="https://market.android.com/details?id=com.smokingbytes.santas">https://market.android.com/details?id=com.smokingbytes.santas</a>&nbsp;and an Iphone app (currently under the approval process) .<br /><br />The backend was written using the Django framework, and the apps interact with it using a json based rest api.</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/18/new-app-android-kitchen-timer/">A New App - Android Kitchen Timer</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2011-10-18'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2011</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
Pastimer is my 4th app. It&#8217;s a simple (but nice) Android Kitchen Timer based on barcode scanning.<br /><br />I learned some things during my journey of android development, but this time I wanted to focus on user interface and ease of use.<br /><br />As always, it starts as a simple idea, the you start putting some code in it, it&#8217;s &#8220;almost&#8221; working, and the difference between almost working and finished, is something like two months or more. I let it alone for more than two months.<br /><br />However, now it almost ready to be released, and it will very soon.<br /><br />The idea behind it is very simple.<br /><br />You point the barcode, the app looks in its internal database, and if it does know the time associated, starts a timer. If it does not recognize the barcode, it prompts the user asking to put the data.<br /><br />Sounds easy, doesn&#8217;t it? You can give a look at a couple of screenshots here&nbsp;<a href="https://sites.google.com/site/pastimerand/">Android Kitchen Timer</a></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/06/24/what-i-have-been-working-on/">What I Have Been Working on.. Android Kitchen Timer</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2011-06-24'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2011</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
Apart from some rest, and reading some good books (like excellent Kent Beck&#8217;s Test Driven development by example, and &#8220;growing object-oriented software guided by tests&#8221;), I have been working on a new app in the last month or so.<br /><br />A week end locked at home because my gf was ill, was a good excuse to start a deep programming session. The app I am about to release (well, to be honest it still lacks all the nice ui parts, it just look like a bunch of grey buttons thrown on the screen) solves (or at least tries to simplify) a problem I have every time I need to cook pasta.<br /><br />Basically, if you need to cook some pasta (but this applies to every other boxed product), you need to put it in the boiling water and then look for the boiling time on the box, and set the timer with minutes and seconds on your phone.<br /><br />With my app you simply point the camera to the barcode of the box, and it automatically start a countdown for the right amount of time. Of course some data entry is needed, and if the barcode is not in the internal storage, the user will be asked to fill the name of the pasta and the correct boiling time.<br /><br />So, it&#8217;s a simplified timer for android, which should make easier and faster the countdown setting process.<br /><br />I really hope to release it soon, if you are interested and you want to be notified when I will release it, just throw me an email at fedepaol <at> gmail.com</at></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/04/25/behind-activities-android-services/">Behind Activities: Android, Services, Background Operations and Threads</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2011-04-25'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2011</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
This time I want to share something I learned about working in background on android.<br /><br />One of the biggest advantages of android over ios (or, at least, some ios version ago) is that your app is not sandboxed and can continue to live in background.<br /><br />To perform background (not visible) work, all you need to know is how to use android services.<br /><br />A service is a piece of an application that is allowed to be active even if the application is not in foreground anymore. The most commonly used example for describing a service is the music player, which need to continue to play music when your app is hidden by something else.<br /><br />First of all, I want to remark a concept I had some problems with: a service does not have any relationship with threads! The service shares the main (ui) thread with the rest of the components of the app. This means that, if your app is in foreground AND you have a service active AND your service performs some time consuming operations, it will affect the responsivness of the gui (and you don&#8217;t want to disappoint your user).<br />So, even if you are now able to perform some background work, if you expect it to be heavy, please move it inside a thread (or an asynctask) hosted by the service.<br /><br />Another advantage of bringing a service on board is that your application will gain priority over the other apps. Android prefers to kill processes that do not have active services. On the other hand, this means that you should use services carefully if you don&#8217;t want to drain your user&#8217;s battery. If you don&#8217;t need a service anymore, please kill it and restart it later (as pointed out from mark murphy in this old but interesting article: <a href="http://www.androidguys.com/2009/09/09/diamonds-are-forever-services-are-not/">http://www.androidguys.com/2009/09/09/diamonds-are-forever-services-are-not/</a>)<br /><br />Said that, I am now going to list some typical service usage patterns<br /><br /><ul><li><span class="Apple-style-span" style="color: red;">Listen and react to events from outside </span>which need to be handled even if the application is not active (and maybe when the device is idle), such as location variation, accelerometer, incoming calls and so on</li><li><span class="Apple-style-span" style="color: red;">Tasks that need to be performed periodically</span>, like polling a mail server every 15 minutes</li><li><span class="Apple-style-span" style="color: red;">Continuous tasks</span> (like playing a song, or sampling the location with a very narrow interval) that need to be performed in background</li></ul><br /><br />I would say the first two are similar, and the third needs to be handled in a different way.<br /><br /><br /><span class="Apple-style-span" style="font-size: large;"><b>One shot tasks</b></span><br />If you need one shot tasks (like downloading your email), you could:<br /><br /><ol><li>start a service with an <i>intent</i></li><li>return <i>START_NOT_STICKY</i> in its <i>onCommand</i> callback</li><li><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">start an <i>AsyncTask</i> to perform the heavy operations</div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">OR</div></li></ol><br /><div style="text-align: center;"><b><span class="Apple-style-span" style="color: red;"><u>you can use an IntentService.&nbsp;</u></span></b></div><div style="text-align: center;"><br /></div>IntentServices are useful as much as they are little advertised.<br />If your service is an intentservice, it will be automatically hosted in its own thread. You can send it as many actions to be performed you want bundled in intents. They will be queued and handled one at a time.<br />You don&#8217;t even have to bother if you need to shut the service down. It will automatically shut down when you return from the <i>onHandleIntent</i> call.&nbsp;Much simple, isn&#8217;t it?<br /><br />Here are some simple scenarios for using intent services:<br /><br /><ul><li><span class="Apple-style-span" style="color: red;">Background operation triggered from user</span> (such as a button):&nbsp;Just pack the command in an intent, and launch the service with the intent.</li><li><span class="Apple-style-span" style="color: red;">React to some broadcast event</span> (such as some system broadcast event):&nbsp;Register a broadcast receiver in your manifest and then launch the intent service from its onReceive. You can&#8217;t handle long running operations in the broadcast receiver, there is a strict time limit in broadcast handling.</li><li><span class="Apple-style-span" style="color: red;">Perform periodic tasks</span>: Use an alarm manager and make it launch your intent service. I also remind you that using setInexactRepeating in this case will help your&nbsp;app to save more resources.</li></ul><br /><br /><b><span class="Apple-style-span" style="font-size: large;">Long running tasks</span></b><br /><br />If you need to need to perform long, continuous background operations, you have no options, and you need a classic service, returning <i>START_STICKY</i> in its <i>onCommand()</i> method.<br />Again, remember that in this case you need to perform time consuming operations inside a thread or an asynctask, because the service shares the same thread with the gui.<br /><br /><br /><br /><a name='more'></a><br /><br /><br />The next time I will try to write down some more practical stuff on how to implement activities and services communication.<br /><br /><br />If I wasn&#8217;t clear enough, if you broke your phone trying to implement this advices, or if you think I&#8217;d better shoot in my foot than writing this ugly stuff in a very poor engRish, drop me an email fedepaol <at> gmail.com .</at><br />If you liked this post, you can consider following me on twitter @fedepaol .<br /><br /><br />UPDATE: I am currently (23/01/2012) working on a library to be used to interact with a service using an intent service. In case you may be interested, you can find it here&nbsp;<a href="https://github.com/fedepaol/PostmanLib--Rings-Twice--Android">PostmanLib - Android webservice interaction</a><br /><br /><div><br /></div></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/03/21/first-18-days-of-pegdroid/">First 18 Days of Pegdroid</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2011-03-21'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2011</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
It&#8217;s already been 18 days, and it&#8217;s time to make some considerations.<br /><br />For those who don&#8217;t know what pegdroid is, it&#8217;s a simple peg solitaire for android. I released it 18 days ago, it&#8217;s free and it&#8217;s basically ad-supported (but I don&#8217;t get much from that).<br /><br /><div>I integrated google analytics in my app, so I can get some help from the statistics I get every day. In the meanwhile, the market dashboard got updated and I also can see which kind of device are the most popular.</div><div><br /></div><div>At the moment, it was downloaded 1022 times (android developer console), and something like 7000 boards were played. Don&#8217;t know why, but it looks like it&#8217;s quite popular in minneapolis :-) .</div><div><br /></div><div>First, there was a huge (or so) number of accesses and downloads the first day (like 350 downloads), and then the number of downloads dropped considerably, as well as the number of accesses, that went from a considerable 1800, to an average of 300 accesses per day. I tried to tweet some news about the game, but I didn&#8217;t experience any noticeable effect.</div><div><br /></div><div>I then released the first update, because some users said it would have been better to have the score expressed in terms of remaing pegs, than in terms of pegs already eaten.</div><div><br /></div><div>With the second update I implemented the undo of the last move, which was a widely requested feature, and I fixed a sporadic crash some anonymous guy reported me.&nbsp;With this update (and not with the previous update) I had a spike in the download and access number, as you can see in the picture.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://lh5.googleusercontent.com/-spugJcGq3ls/TYejCvV_CrI/AAAAAAAAE-A/fydCT3O9gBE/s1600/analytics.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="90" src="https://lh5.googleusercontent.com/-spugJcGq3ls/TYejCvV_CrI/AAAAAAAAE-A/fydCT3O9gBE/s400/analytics.jpg" width="400" /></a></div><br /></div><div><br /></div><div>I am really curious on what drives the download number, at the moment I can only say that updates have a positive effect. The next move is to integrate some kind of social gaming platform (I am still evaluating)..<br /></div><div><br /></div><div>In any case, if you haven&#8217;t downloaded pegdroid yet, here you can find the link to the market:</div><div><br /></div><div><a href="https://market.android.com/details?id=com.whiterabbit.checkers">Pegdroid</a></div></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Pharaviel</div>
<div class='content'>
Ti lascio un piccolo commento per ringraziarti del fantastico lavoro che hai fatto con GeoTagger per android, sono un fotoamatore e apprezzo molto di poter usare le funzioni di iphoto senza dover comprare un costosissimo gps per la mia fotocamera!<br />Darò volentieri uno sguardo a pegdroid visto che ogni tanto giochicchio con il telefono.<br /><br />Ok basta sproloqui, grazie ancora!</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/03/03/pegdroid/">PegDroid - Android Simple Game</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2011-03-03'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2011</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
I just released a new game. It&#8217;s (yet another) version of the popular solitaire game. I thought its name was &#8220;Chinese checkers&#8221;, but it looks like it&#8217;s most common name is &#8220;Peg&#8221;. Anyway, it didn&#8217;t take (too) much to develop it, I really enjoyed learning something about the powerful andengine framework, but I am still proceeding at a slow pace since I can work on android only after my daytime job.<br /><div><br /></div><div>I am releasing it with ads, but in any case I think I will update the sources on github very soon. Now it&#8217;s quite late and I&#8217;m afraid to make some mistake. </div><div><br /></div><div>Good points: the framework and the assets. I think my favourite designer (yes, still my gf) has done a good job in drawing all the assets. Very far from what I would have been done alone.</div><div><br /></div><div>Another thing I tried to include in this app is google analytics. I can see which are the most played boards, and who downloads my app. I must say I am pretty curious.</div><div><br /></div><div>Next time I promise to post some technical stuff, for example how I handled andengine stuff in a more structured way in my new app. </div><div><br /></div><div>I will end including the demo video of PegDroid down here:</div><div><br /></div><div><br /><iframe allowfullscreen="" frameborder="0" height="390" src="http://www.youtube.com/embed/HOXvHJUKfb4" title="YouTube video player" width="480"></iframe></div></div>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/4">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/2">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p>Lead developer with electronic trading software by day, passionate about opensource. I spend a lot of my spare time writing Go and Android software. Table Tennis player, snowboarder, dad. I also contributed to Firefox for Android.</p>
  <a href="mailto:fedepaol@gmail.com" target="_top">fedepaol@gmail.com</a>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2018/10/27/fast-messaging-with-nats-and-go/">Fast Messaging With Nats and Go</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/10/26/a-new-chapter/">A New (Side) Chapter</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/04/30/android-okhttp-and-websockets/">Android, Okhttp and Websockets</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/08/27/android-mvp-testing/">Android, MVP, Dagger and Testing</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/06/20/how-to-a-timer/">Reactive Android Timers, Countdowns and Lifecycle</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/fedepaol">@fedepaol</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'fedepaol',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/+FedericoPaolinelli?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



<section>
	<h1>On Twitter:</h1>
	<div>
		<p><br /><a href="http://twitter.com/fedepaol" target="_blank">My Tweets, on Twitter.</a></p>
		<a href="http://twitter.com/fedepaol" class="twitter-follow-button" data-show-count="">Follow @fedepaol</a>
	</div>
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2018 - Federico Paolinelli -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'fedepaolgithubio';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
